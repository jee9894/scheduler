--DB생성(cmd)
--sqlplus "/as sysdba"
--create user sch identified by sch; 
--grant connect, resource, dba to sch; 


-- 기존 테이블이 있다면 옆에서 테이블 확인 후 현재 존재하는 테이블만 DROP TABLE 명령어 수행

DROP TABLE ASSIGNMENT;
DROP TABLE ENTERPRISE;
DROP TABLE LECTURE;
DROP TABLE MEMBER;
COMMIT;

-- 밑에 명령어로 SEQUENCE 확인 후 있는 것만 DROP SEQUENCE
SELECT * FROM USER_SEQUENCES;

drop sequence seq_id;
drop sequence ent_id;
drop sequence lec_id;

COMMIT;

-- 처음 테이블 만들면 여기부터 실행

 CREATE TABLE MEMBER 
   (	SEQ_ID NUMBER PRIMARY KEY, 
	MEM_ID VARCHAR2(255) NOT NULL UNIQUE, 
	MEM_PW VARCHAR2(255) NOT NULL, 
	MEM_NAME VARCHAR2(255) NOT NULL
   );
  
 

  CREATE TABLE ENTERPRISE
   (	ENT_ID NUMBER PRIMARY KEY, 
	ENT_NAME VARCHAR2(255) NOT NULL, 
	PAPER_END DATE, 
	INTERVIEW1 DATE, 
	INTERVIEW2 DATE, 
	INTERVIEW3 DATE, 
	SEQ_ID NUMBER NOT NULL, 
	 CONSTRAINT SEQ_FK FOREIGN KEY (SEQ_ID)
	  REFERENCES MEMBER(SEQ_ID) ON DELETE CASCADE 
   );


  CREATE TABLE LECTURE
   (	LEC_ID NUMBER PRIMARY KEY,  
	LEC_NAME VARCHAR2(255 BYTE) NOT NULL, 
	LEC_START DATE, 
	LEC_END DATE, 
	SEQ_ID NUMBER NOT NULL, 
	 CONSTRAINT SEQ_ID_FK FOREIGN KEY (SEQ_ID)
	  REFERENCES MEMBER(SEQ_ID) ON DELETE CASCADE
   ); 


 CREATE TABLE ASSIGNMENT
   (	LEC_ID NUMBER NOT NULL, 
	ASIGN_END DATE, 
	ASIGN_NAME VARCHAR2(255) NOT NULL,
	SEQ_ID NUMBER NOT NULL,
	 CONSTRAINT LEC_FK FOREIGN KEY (LEC_ID)
	  REFERENCES LECTURE ("LEC_ID") ON DELETE CASCADE,
	CONSTRAINT SEQ_ID_Assign_FK FOREIGN KEY (SEQ_ID)
	  REFERENCES MEMBER(SEQ_ID) ON DELETE CASCADE
   );
 

CREATE SEQUENCE seq_id START WITH 1 
INCREMENT BY 1 MAXVALUE 10000 NOCYCLE;

CREATE SEQUENCE ent_id START WITH 1 
INCREMENT BY 1 MAXVALUE 10000 NOCYCLE;

CREATE SEQUENCE lec_id START WITH 1 
INCREMENT BY 1 MAXVALUE 10000 NOCYCLE;

COMMIT;